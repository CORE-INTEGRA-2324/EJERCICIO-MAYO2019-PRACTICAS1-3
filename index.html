<html>
    <head>
        <title>Calculadora de CORE - INTEGRA</title>
        <meta charset="utf-8">
        <link rel="stylesheet" href="styles.css">
        <script type="text/javascript">
            // FUNCIONES ÚTILES PARA LA CALCULADORA
            let acumulador = 0;
            let operador = "";
            let arrayValoresAcumulados = [];
            let modoLite = true;

            const getInputValue = () => {
                return Number(document.getElementById("pantalla").value);
            };

            const setInputValue = (valor) => {
                document.getElementById("pantalla").value = valor;
            }

            const vaciarInput = () => {
                document.getElementById("pantalla").value = "";
            }

            const validNumber = () => {
                if ( Number.isNaN(getInputValue()) ) {
                    acumulador = 0;
                    operador = "";
                    setInputValue("Error");
                    return false;
                }
                return true;
            }

            const rellenarInfo = () => {
                const resultadoInput = getInputValue();
                let mensaje = "";

                if (Number.isNaN(resultadoInput)) {
                    mensaje = "ERROR";
                }

                else {
                    if (resultadoInput < 100) {
                        mensaje = "Info: El resultado es menor que 100";
                    }
                    else if (resultadoInput <= 200) {
                        mensaje = "Info: El resultado está entre 100 y 200";
                    }
                    else {
                        mensaje = "Info: El resultado es superior a 200";
                    }
                }
                document.getElementById("info").innerHTML = mensaje;
            }

            // OPERACIONES UNITARIAS
            const sq = () => {
                if(!validNumber()) return;
                let inputValue = getInputValue();
                setInputValue(inputValue*inputValue);
                rellenarInfo();
            }

            const fact = () => {
                if(!validNumber()) return;
                let inputValue = getInputValue();
                let resultado = 1;
                for (let index = inputValue; index > 1; index--) {
                    resultado *= index;
                    // resultado = resultado * index;
                }
                setInputValue(resultado);
                rellenarInfo();
            }

            const sqr = () => {
                if(!validNumber()) return;
                let inputValue = getInputValue();
                let resultado = Math.sqrt(inputValue);
                setInputValue(resultado);
                rellenarInfo();
            };

            // OPERACIONES OPCIONALES

            let listaValores = "<ul>"
            let cierreListaAcumulador = "</ul>"

            const addToList = () => {
                let inputValue = getInputValue();
                listaValores += `<li>${inputValue}</li>`;
                let listaCerrada = listaValores + cierreListaAcumulador;
                document.getElementById("valoresAcumulador").innerHTML = listaCerrada;
            }

            const addValorAcumulado = (n) => {
                document.getElementById("valorAcumulado").innerHTML = n;
            }

            const addToListArray = () => {
                let listaValoresArray = "<ul>"
                arrayValoresAcumulados.push(getInputValue());

                // Método con bucle for:
                for(let i = 0; i < arrayValoresAcumulados.length; i++){
                    listaValoresArray += `<li>${arrayValoresAcumulados[i]}</li>`;
                }

                /* Método con .forEach()
                arrayValoresAcumulados.forEach((elemento) => {
                    vista += `<li>${elemento}</li>`;
                });
                */
                document.getElementById("valoresAcumuladorArray").innerHTML = listaValoresArray + cierreListaAcumulador;
            }

            // OPERACIONES BINARIAS

            const acumula = n => {
                switch (operador) {
                    case "":
                        acumulador = n;
                        addValorAcumulado(acumulador);
                        break;
                    case "+":
                        acumulador += n;
                        break;
                    case "-":
                        acumulador -= n;
                        break;
                    case "*":
                        acumulador *= n;
                        break;
                    case "/":
                        acumulador /= n;
                        break;
                }
            }

            const add = () => {
                if(!validNumber()) return;
                acumula(getInputValue());
                operador = "+";
                vaciarInput();
                rellenarInfo();
            }

            const sub = () => {
                if(!validNumber()) return;
                acumula(getInputValue());
                operador = "-";
                vaciarInput();
                rellenarInfo();
            }

            const mul = () => {
                if(!validNumber()) return;
                acumula(getInputValue());
                operador = "*";
                vaciarInput();
                rellenarInfo();
            }
            
            const div = () => {
                if(!validNumber()) return;
                acumula(getInputValue());
                operador = "/";
                vaciarInput();
                rellenarInfo();
            }

            const eq = () => {
                if(!validNumber()) return;
                acumula(getInputValue());
                operador = "";
                setInputValue(acumulador);
                rellenarInfo();
            }

            let contadorClicks = 0;
            const ocultarInput = () => {
                contadorClicks++;
                document.getElementById("contadorClicks").innerHTML = contadorClicks;

                if(contadorClicks == 3){
                    contadorClicks = 0;
                    document.getElementById("input_texto").style.display = "none";
                }
            };

            const compararNumeros = () => {
                let resultado = "";
                let getValueInputAComparar = Number(document.getElementById("numeroAComparar").value);
                let valorInput = getInputValue();

                if (getValueInputAComparar >= valorInput) {
                    resultado = "Mayor o igual que el input."
                }
                else {
                    resultado = "Menor que el input."
                }
                document.getElementById("resultadoComparacion").innerHTML = resultado;
            };

            const insertar = (s) => {
                setInputValue(getInputValue().toString() + s);
            };

            const log = () => {
                if(!validNumber()) return;
                let inputValue = Number(document.getElementById("pantalla").value);
                let logOfValue = Math.log(inputValue);
                let textoResultado = document.getElementById("resultadoLn");
                textoResultado.innerHTML = logOfValue;

                let subtituloLn = document.getElementById("subtituloLn");
                subtituloLn.style.color = "green";
                subtituloLn.style.backgroundColor = "lightyellow";
            };

            const clearScreen = () => {
                document.getElementById("pantalla").value = 0;
            };

            const clearAll = () => {
                clearScreen();
                acumulador = 0;
            };

            //Modo Lite

            const cambiaModo = () => {
                console.log("cambio modo!");
            };

            const onload = () => {
                // OPERACIONES UNITARIAS
                document.getElementById("cuadrado").addEventListener("click", sq);
                document.getElementById("factorial").addEventListener("click", fact);
                document.getElementById("raiz").addEventListener("click", sqr);
                document.getElementById("logaritmo").addEventListener("click", log);

                //OPERACIONES BINARIAS
                document.getElementById("suma").addEventListener("click", add);
                document.getElementById("resta").addEventListener("click", sub);
                document.getElementById("multiplicacion").addEventListener("click", mul);
                document.getElementById("division").addEventListener("click", div);
                document.getElementById("igual").addEventListener("click", eq);

                //LIMPIEZA
                document.getElementById("clearScreen").addEventListener("click", clearScreen);
                document.getElementById("clearAll").addEventListener("click", vaciarInput);


                // MANEJO DE PULSACIÓN AL INPUT
                document.getElementById("input_texto").addEventListener("click", vaciarInput);

                // OPERACIONES OPCIONALES
                document.getElementById("addValueToList").addEventListener("click", addToList);
                document.getElementById("addValueToListArray").addEventListener("click", addToListArray);
                document.getElementById("ocultador").addEventListener("click", ocultarInput);
                document.getElementById("compararNumeros").addEventListener("click", compararNumeros);
                document.getElementById("cien").addEventListener("click", () => { insertar(100); });

                // Modo Lite
                if(modoLite){
                    document.getElementById("modoLiteTitle").innerHTML = "Modo Lite";
                }

                document.getElementById("lite").addEventListener("click", cambiaModo);
            }

            window.onload = onload ;
        </script>
    </head>
    <body>
        <h1>Academia INTEGRA</h1>
        <h2 class="cabecera">Calculadora de CORE - INTEGRA</h2>

        <div id="input_texto">
            <label for="pantalla">Número:</label>
            <input type="text" id="pantalla">
        </div>

        <h3 class="cabecera" title="Unitarias">Operaciones unitarias</h3>
        <div class="operaciones">
            <button id="cuadrado"> x<sup>2</sup></button>
            <button id="factorial"> x! </button>
            <button id="raiz"> &#8730 x</button>
            <button id="logaritmo">ln(x)</button>
        </div>

        <h3 class="cabecera" title="Unitarias">Limpieza</h3>
        <div class="operaciones">
            <button id="clearScreen">C</button>
            <button id="clearAll">AC</button>
        </div>

        <h4 id="subtituloLn">El resultado del ln(x) es igual a:<span id="resultadoLn"></span></h4>

        <h4>Input comparador:</h4>
        <div>
            <label for="pantalla">Número a comparar con input:</label>
            <input type="text" id="numeroAComparar">
            <button id="compararNumeros">Compara!</button>
            <p>Este número es: <span id="resultadoComparacion"></span></p>
        </div>

        <div id="tecladoMatricial">
            <h4>Teclado Matricial</h4>
            <div id="teclas">
                <button onclick="insertar('1')">1</button>
                <button onclick="insertar('2')">2</button>
                <button onclick="insertar('3')">3</button>
                <button onclick="insertar('4')">4</button>
                <button onclick="insertar('5')">5</button>
                <button onclick="insertar('6')">6</button>
                <button onclick="insertar('7')">7</button>
                <button onclick="insertar('8')">8</button>
                <button onclick="insertar('9')">9</button>
                <button onclick="insertar('.')">.</button>
                <button onclick="vaciarInput()">C</button>
                <button id="cien">100</button>
            </div>
        </div>
        
        <h2 id="info" class="grande" title="Info sobre el número">Info sobre el número</h2>

        <h3 class="cabecera" title="binarias">Operaciones binarias</h3>
        <div class="operaciones">
            <button id="suma"> + </button>
            <button id="resta"> - </button>
            <button id="multiplicacion"> * </button>
            <button id="division"> / </button>
            <button id="igual"> = </button>
        </div>

        <div class="opcionales">
            <h3 class="cabecera">Elementos opcionales</h3>
            <h4>Valor acumulado: <span id="valorAcumulado">0</span></h4>
            <button id="addValueToList">Añadir a lista</button>
            <button id="addValueToListArray">Añadir a lista con Array</button>
            <div class="listadoOperaciones">
                <h4>Listado:</h4>
                <div id="valoresAcumulador"></div>
            </div>
            <div class="listadoOperaciones">
                <h4>Listado con Array:</h4>
                <div id="valoresAcumuladorArray"></div>
            </div>
            <h4>Botón ocultador</h4>
            <p>Número de clicks: <span id="contadorClicks">0</span></p>
            <button id="ocultador">Púlsame 3 veces y ocultaré cosis</button>
        </div>

        <h2>Ejercicios Práctica 3 - Calculadora JS</h2>

        <h3>Interface en estado: <span id="modoLiteTitle"></span></h3>
        <button id="lite">Modo Lite</button>

        <div id="vistaFull">
            <button id="cuadrado"> x<sup>2</sup></button>
            <button id="factorial"> x! </button>
        </div>

        <div>
            <button id="suma"> + </button>
            <button id="resta"> - </button>
            <button id="multiplicacion"> * </button>
            <button id="division"> / </button>
            <button id="igual"> = </button>
        </div>
    </body>
</html>
